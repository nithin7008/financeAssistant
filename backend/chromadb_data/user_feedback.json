[
  {
    "question": "what is my total net worth?",
    "generated_sql": "SELECT (SUM(balance) FROM account_weekly_snapshot WHERE type IN ('checking', 'stocks', 'crypto') AND last_updated_date = (SELECT MAX(last_updated_date) FROM account_weekly_snapshot)) - SUM(balance) as net_worth FROM account_weekly_snapshot WHERE type = 'credit' AND last_updated_date = (SELECT MAX(last_updated_date) FROM account_weekly_snapshot);",
    "corrected_sql": "WITH LatestSnapshots AS (\n  SELECT\n    bank,\n    type,\n    balance,\n    payment_due,\n    last_updated_date,\n    ROW_NUMBER() OVER (PARTITION BY bank, type ORDER BY last_updated_date DESC) AS rn\n  FROM account_weekly_snapshot\n)\n\nSELECT\n  (\n    -- Sum assets: checking, stocks, crypto\n    (SELECT COALESCE(SUM(balance), 0) FROM LatestSnapshots WHERE type IN ('checking', 'stocks', 'crypto') AND rn = 1)\n    -\n    -- Sum debts: credit\n    (SELECT COALESCE(SUM(balance), 0) FROM LatestSnapshots WHERE type = 'credit' AND rn = 1)\n  ) AS net_worth;\n",
    "feedback": "bad",
    "id": "feedback_0",
    "timestamp": "2025-06-22T15:41:00.040889"
  }
]